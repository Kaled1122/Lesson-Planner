<script>
  async function uploadFile() {
    const fileInput = document.getElementById('fileInput');
    const outputDiv = document.getElementById('output');

    if (!fileInput.files.length) {
      outputDiv.innerHTML = "<p style='color:red'>Please select a file.</p>";
      return;
    }

    const formData = new FormData();
    formData.append("file", fileInput.files[0]);

    outputDiv.innerHTML = "<p>⏳ Generating your lesson plan...</p>";

    try {
      const response = await fetch("https://lesson-planner-9gmh.onrender.com/generate", {
        method: "POST",
        body: formData
      });

      const data = await response.json();

      if (data.lesson_plan) {
        outputDiv.innerHTML = `<h3>✅ Generated Lesson Plan:</h3><pre>${data.lesson_plan}</pre>`;
      } else {
        outputDiv.innerHTML = `<p style='color:red'>Error: ${data.error || "Unknown error"}</p>`;
      }
    } catch (err) {
      outputDiv.innerHTML = `<p style='color:red'>Server error: ${err.message}</p>`;
    }
  }
</script>
